import fs from 'fs'
import _ from 'lodash-es'
import w from 'wsemi'
import assert from 'assert'
import wf from '../src/WFft.mjs'


describe(`spectrum1d_128p`, function() {

    //dt=0.0078125s, 3+6hz
    let dt = 0.0078125

    let arr = [
        0,
        0.437015151709824,
        0.845854910274064,
        1.20056554679302,
        1.47944976553089,
        1.66674368151922,
        1.75379573376597,
        1.73964987434863,
        1.63098631369783,
        1.44142799002054,
        1.19027504868833,
        0.900778315875612,
        0.598101848038141,
        0.307150781019375,
        0.0504516520458098,
        -0.153732804251563,
        -0.292893218813452,
        -0.361241031239776,
        -0.360072875476548,
        -0.297503430771426,
        -0.187593110348962,
        -0.0489494660021425,
        0.0970731816865672,
        0.228416556922734,
        0.324423348821458,
        0.367818520155133,
        0.346391996239585,
        0.254233601317238,
        0.0924099202087415,
        -0.130978839760706,
        -0.401370102712605,
        -0.698891832710318,
        -1,
        -1.27946118721924,
        -1.51251056875181,
        -1.67699974648618,
        -1.75534914481383,
        -1.73613585202716,
        -1.61517856456688,
        -1.39602400854158,
        -1.08979021355164,
        -0.714376916729265,
        -0.293107462345689,
        0.147084814656977,
        0.577773754381215,
        0.971283137555866,
        1.30286634912854,
        1.55263964022464,
        1.70710678118655,
        1.76014786721285,
        1.7133908766509,
        1.57593734934667,
        1.36346871276832,
        1.09681259653473,
        0.80009440465607,
        0.498634516368545,
        0.216772751324739,
        -0.0241926543480825,
        -0.207774827040493,
        -0.323625771825179,
        -0.368309299491684,
        -0.345455359932455,
        -0.265285555765141,
        -0.1435542027991,
        -3.67544536472586E-16,
        0.1435542027991,
        0.26528555576514,
        0.345455359932455,
        0.368309299491684,
        0.323625771825179,
        0.207774827040493,
        0.0241926543480835,
        -0.216772751324738,
        -0.498634516368544,
        -0.800094404656069,
        -1.09681259653473,
        -1.36346871276832,
        -1.57593734934667,
        -1.7133908766509,
        -1.76014786721285,
        -1.70710678118655,
        -1.55263964022464,
        -1.30286634912855,
        -0.971283137555864,
        -0.577773754381218,
        -0.14708481465698,
        0.293107462345686,
        0.714376916729258,
        1.08979021355163,
        1.39602400854158,
        1.61517856456688,
        1.73613585202716,
        1.75534914481383,
        1.67699974648618,
        1.51251056875181,
        1.27946118721924,
        1,
        0.698891832710321,
        0.40137010271261,
        0.130978839760704,
        -0.0924099202087405,
        -0.254233601317238,
        -0.346391996239584,
        -0.367818520155133,
        -0.324423348821457,
        -0.228416556922734,
        -0.0970731816865679,
        0.0489494660021418,
        0.18759311034896,
        0.297503430771423,
        0.360072875476548,
        0.361241031239776,
        0.292893218813452,
        0.153732804251566,
        -0.0504516520458086,
        -0.307150781019376,
        -0.598101848038137,
        -0.900778315875611,
        -1.19027504868833,
        -1.44142799002054,
        -1.63098631369783,
        -1.73964987434863,
        -1.75379573376597,
        -1.66674368151922,
        -1.47944976553089,
        -1.20056554679302,
        -0.845854910274064,
        -0.43701515170983,
    ]

    it(`should return 'spectrum1d_128p.json' when spectrum1d(arr, ${dt})`, async function() {
        let res = wf.spectrum1d(arr, dt)
        let rs = JSON.stringify(res)
        let rt = fs.readFileSync('./test/spectrum1d_128p.json', 'utf8')
        assert.strict.deepStrictEqual(rs, rt)
    })

})
