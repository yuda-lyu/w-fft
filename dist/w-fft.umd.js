/*!
 * w-fft v1.0.6
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(r="undefined"!=typeof globalThis?globalThis:r||self)["w-fft"]=t()}(this,(function(){"use strict";var r=Array.isArray,t="object"==typeof global&&global&&global.Object===Object&&global,e="object"==typeof self&&self&&self.Object===Object&&self,n=t||e||Function("return this")(),o=n.Symbol,i=Object.prototype,f=i.hasOwnProperty,a=i.toString,u=o?o.toStringTag:void 0;var c=Object.prototype.toString;var l="[object Null]",s="[object Undefined]",v=o?o.toStringTag:void 0;function p(r){return null==r?void 0===r?s:l:v&&v in Object(r)?function(r){var t=f.call(r,u),e=r[u];try{r[u]=void 0;var n=!0}catch(r){}var o=a.call(r);return n&&(t?r[u]=e:delete r[u]),o}(r):function(r){return c.call(r)}(r)}function y(r){return null!=r&&"object"==typeof r}var d="[object Symbol]";function h(r){return"symbol"==typeof r||y(r)&&p(r)==d}var b=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m=/^\w*$/;function g(r){var t=typeof r;return null!=r&&("object"==t||"function"==t)}var j="[object AsyncFunction]",_="[object Function]",w="[object GeneratorFunction]",A="[object Proxy]";function O(r){if(!g(r))return!1;var t=p(r);return t==_||t==w||t==j||t==A}var x,S=n["__core-js_shared__"],T=(x=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+x:"";var F=Function.prototype.toString;function M(r){if(null!=r){try{return F.call(r)}catch(r){}try{return r+""}catch(r){}}return""}var $=/^\[object .+?Constructor\]$/,E=Function.prototype,z=Object.prototype,P=E.toString,D=z.hasOwnProperty,N=RegExp("^"+P.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function k(r){return!(!g(r)||(t=r,T&&T in t))&&(O(r)?N:$).test(M(r));var t}function I(r,t){var e=function(r,t){return null==r?void 0:r[t]}(r,t);return k(e)?e:void 0}var R=I(Object,"create");var U=Object.prototype.hasOwnProperty;var B=Object.prototype.hasOwnProperty;function q(r){var t=-1,e=null==r?0:r.length;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}function C(r,t){return r===t||r!=r&&t!=t}function V(r,t){for(var e=r.length;e--;)if(C(r[e][0],t))return e;return-1}q.prototype.clear=function(){this.__data__=R?R(null):{},this.size=0},q.prototype.delete=function(r){var t=this.has(r)&&delete this.__data__[r];return this.size-=t?1:0,t},q.prototype.get=function(r){var t=this.__data__;if(R){var e=t[r];return"__lodash_hash_undefined__"===e?void 0:e}return U.call(t,r)?t[r]:void 0},q.prototype.has=function(r){var t=this.__data__;return R?void 0!==t[r]:B.call(t,r)},q.prototype.set=function(r,t){var e=this.__data__;return this.size+=this.has(r)?0:1,e[r]=R&&void 0===t?"__lodash_hash_undefined__":t,this};var W=Array.prototype.splice;function G(r){var t=-1,e=null==r?0:r.length;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}G.prototype.clear=function(){this.__data__=[],this.size=0},G.prototype.delete=function(r){var t=this.__data__,e=V(t,r);return!(e<0)&&(e==t.length-1?t.pop():W.call(t,e,1),--this.size,!0)},G.prototype.get=function(r){var t=this.__data__,e=V(t,r);return e<0?void 0:t[e][1]},G.prototype.has=function(r){return V(this.__data__,r)>-1},G.prototype.set=function(r,t){var e=this.__data__,n=V(e,r);return n<0?(++this.size,e.push([r,t])):e[n][1]=t,this};var L=I(n,"Map");function Z(r,t){var e,n,o=r.__data__;return("string"==(n=typeof(e=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?o["string"==typeof t?"string":"hash"]:o.map}function H(r){var t=-1,e=null==r?0:r.length;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}H.prototype.clear=function(){this.size=0,this.__data__={hash:new q,map:new(L||G),string:new q}},H.prototype.delete=function(r){var t=Z(this,r).delete(r);return this.size-=t?1:0,t},H.prototype.get=function(r){return Z(this,r).get(r)},H.prototype.has=function(r){return Z(this,r).has(r)},H.prototype.set=function(r,t){var e=Z(this,r),n=e.size;return e.set(r,t),this.size+=e.size==n?0:1,this};var J="Expected a function";function K(r,t){if("function"!=typeof r||null!=t&&"function"!=typeof t)throw new TypeError(J);var e=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=e.cache;if(i.has(o))return i.get(o);var f=r.apply(this,n);return e.cache=i.set(o,f)||i,f};return e.cache=new(K.Cache||H),e}K.Cache=H;var Q,X,Y,rr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,tr=/\\(\\)?/g,er=(Q=function(r){var t=[];return 46===r.charCodeAt(0)&&t.push(""),r.replace(rr,(function(r,e,n,o){t.push(n?o.replace(tr,"$1"):e||r)})),t},X=K(Q,(function(r){return 500===Y.size&&Y.clear(),r})),Y=X.cache,X),nr=er;var or=1/0,ir=o?o.prototype:void 0,fr=ir?ir.toString:void 0;function ar(t){if("string"==typeof t)return t;if(r(t))return function(r,t){for(var e=-1,n=null==r?0:r.length,o=Array(n);++e<n;)o[e]=t(r[e],e,r);return o}(t,ar)+"";if(h(t))return fr?fr.call(t):"";var e=t+"";return"0"==e&&1/t==-or?"-0":e}function ur(t,e){return r(t)?t:function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!h(t))||m.test(t)||!b.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:nr(function(r){return null==r?"":ar(r)}(t))}var cr=1/0;function lr(r){if("string"==typeof r||h(r))return r;var t=r+"";return"0"==t&&1/r==-cr?"-0":t}function sr(r,t,e){var n=null==r?void 0:function(r,t){for(var e=0,n=(t=ur(t,r)).length;null!=r&&e<n;)r=r[lr(t[e++])];return e&&e==n?r:void 0}(r,t);return void 0===n?e:n}var vr=Object.prototype;var pr=function(r,t){return function(e){return r(t(e))}}(Object.keys,Object),yr=pr,dr=Object.prototype.hasOwnProperty;function hr(r){if(e=(t=r)&&t.constructor,t!==("function"==typeof e&&e.prototype||vr))return yr(r);var t,e,n=[];for(var o in Object(r))dr.call(r,o)&&"constructor"!=o&&n.push(o);return n}var br=I(n,"DataView"),mr=I(n,"Promise"),gr=I(n,"Set"),jr=I(n,"WeakMap"),_r="[object Map]",wr="[object Promise]",Ar="[object Set]",Or="[object WeakMap]",xr="[object DataView]",Sr=M(br),Tr=M(L),Fr=M(mr),Mr=M(gr),$r=M(jr),Er=p;(br&&Er(new br(new ArrayBuffer(1)))!=xr||L&&Er(new L)!=_r||mr&&Er(mr.resolve())!=wr||gr&&Er(new gr)!=Ar||jr&&Er(new jr)!=Or)&&(Er=function(r){var t=p(r),e="[object Object]"==t?r.constructor:void 0,n=e?M(e):"";if(n)switch(n){case Sr:return xr;case Tr:return _r;case Fr:return wr;case Mr:return Ar;case $r:return Or}return t});var zr=Er,Pr=9007199254740991;function Dr(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=Pr}function Nr(r){return null!=r&&Dr(r.length)&&!O(r)}var kr="[object String]";var Ir,Rr=(Ir="length",function(r){return null==r?void 0:r[Ir]}),Ur=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Br="\\ud800-\\udfff",qr="["+Br+"]",Cr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Vr="\\ud83c[\\udffb-\\udfff]",Wr="[^"+Br+"]",Gr="(?:\\ud83c[\\udde6-\\uddff]){2}",Lr="[\\ud800-\\udbff][\\udc00-\\udfff]",Zr="(?:"+Cr+"|"+Vr+")"+"?",Hr="[\\ufe0e\\ufe0f]?",Jr=Hr+Zr+("(?:\\u200d(?:"+[Wr,Gr,Lr].join("|")+")"+Hr+Zr+")*"),Kr="(?:"+[Wr+Cr+"?",Cr,Gr,Lr,qr].join("|")+")",Qr=RegExp(Vr+"(?="+Vr+")|"+Kr+Jr,"g");function Xr(r){return function(r){return Ur.test(r)}(r)?function(r){for(var t=Qr.lastIndex=0;Qr.test(r);)++t;return t}(r):Rr(r)}var Yr="[object Map]",rt="[object Set]";function tt(t){if(null==t)return 0;if(Nr(t))return"string"==typeof(e=t)||!r(e)&&y(e)&&p(e)==kr?Xr(t):t.length;var e,n=zr(t);return n==Yr||n==rt?t.size:hr(t).length}function et(r,t){for(var e=-1,n=null==r?0:r.length;++e<n&&!1!==t(r[e],e,r););return r}var nt,ot=function(r,t,e){for(var n=-1,o=Object(r),i=e(r),f=i.length;f--;){var a=i[nt?f:++n];if(!1===t(o[a],a,o))break}return r},it=ot;function ft(r){return y(r)&&"[object Arguments]"==p(r)}var at=Object.prototype,ut=at.hasOwnProperty,ct=at.propertyIsEnumerable,lt=ft(function(){return arguments}())?ft:function(r){return y(r)&&ut.call(r,"callee")&&!ct.call(r,"callee")},st=lt;var vt="object"==typeof exports&&exports&&!exports.nodeType&&exports,pt=vt&&"object"==typeof module&&module&&!module.nodeType&&module,yt=pt&&pt.exports===vt?n.Buffer:void 0,dt=(yt?yt.isBuffer:void 0)||function(){return!1},ht=9007199254740991,bt=/^(?:0|[1-9]\d*)$/;function mt(r,t){var e=typeof r;return!!(t=null==t?ht:t)&&("number"==e||"symbol"!=e&&bt.test(r))&&r>-1&&r%1==0&&r<t}var gt={};gt["[object Float32Array]"]=gt["[object Float64Array]"]=gt["[object Int8Array]"]=gt["[object Int16Array]"]=gt["[object Int32Array]"]=gt["[object Uint8Array]"]=gt["[object Uint8ClampedArray]"]=gt["[object Uint16Array]"]=gt["[object Uint32Array]"]=!0,gt["[object Arguments]"]=gt["[object Array]"]=gt["[object ArrayBuffer]"]=gt["[object Boolean]"]=gt["[object DataView]"]=gt["[object Date]"]=gt["[object Error]"]=gt["[object Function]"]=gt["[object Map]"]=gt["[object Number]"]=gt["[object Object]"]=gt["[object RegExp]"]=gt["[object Set]"]=gt["[object String]"]=gt["[object WeakMap]"]=!1;var jt="object"==typeof exports&&exports&&!exports.nodeType&&exports,_t=jt&&"object"==typeof module&&module&&!module.nodeType&&module,wt=_t&&_t.exports===jt&&t.process,At=function(){try{var r=_t&&_t.require&&_t.require("util").types;return r||wt&&wt.binding&&wt.binding("util")}catch(r){}}(),Ot=At&&At.isTypedArray,xt=Ot?function(r){return function(t){return r(t)}}(Ot):function(r){return y(r)&&Dr(r.length)&&!!gt[p(r)]},St=xt,Tt=Object.prototype.hasOwnProperty;function Ft(t,e){var n=r(t),o=!n&&st(t),i=!n&&!o&&dt(t),f=!n&&!o&&!i&&St(t),a=n||o||i||f,u=a?function(r,t){for(var e=-1,n=Array(r);++e<r;)n[e]=t(e);return n}(t.length,String):[],c=u.length;for(var l in t)!e&&!Tt.call(t,l)||a&&("length"==l||i&&("offset"==l||"parent"==l)||f&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||mt(l,c))||u.push(l);return u}function Mt(r){return Nr(r)?Ft(r):hr(r)}var $t=function(r,t){return function(e,n){if(null==e)return e;if(!Nr(e))return r(e,n);for(var o=e.length,i=t?o:-1,f=Object(e);(t?i--:++i<o)&&!1!==n(f[i],i,f););return e}}((function(r,t){return r&&it(r,t,Mt)})),Et=$t;function zt(r){return r}function Pt(t,e){var n;return(r(t)?et:Et)(t,"function"==typeof(n=e)?n:zt)}var Dt=Math.ceil,Nt=Math.max;var kt=/\s/;var It=/^\s+/;function Rt(r){return r?r.slice(0,function(r){for(var t=r.length;t--&&kt.test(r.charAt(t)););return t}(r)+1).replace(It,""):r}var Ut=NaN,Bt=/^[-+]0x[0-9a-f]+$/i,qt=/^0b[01]+$/i,Ct=/^0o[0-7]+$/i,Vt=parseInt;var Wt=1/0,Gt=17976931348623157e292;function Lt(r){return r?(r=function(r){if("number"==typeof r)return r;if(h(r))return Ut;if(g(r)){var t="function"==typeof r.valueOf?r.valueOf():r;r=g(t)?t+"":t}if("string"!=typeof r)return 0===r?r:+r;r=Rt(r);var e=qt.test(r);return e||Ct.test(r)?Vt(r.slice(2),e?2:8):Bt.test(r)?Ut:+r}(r))===Wt||r===-Wt?(r<0?-1:1)*Gt:r==r?r:0:0===r?r:0}var Zt=function(r){return function(t,e,n){return n&&"number"!=typeof n&&function(r,t,e){if(!g(e))return!1;var n=typeof t;return!!("number"==n?Nr(e)&&mt(t,e.length):"string"==n&&t in e)&&C(e[t],r)}(t,e,n)&&(e=n=void 0),t=Lt(t),void 0===e?(e=t,t=0):e=Lt(e),function(r,t,e,n){for(var o=-1,i=Nt(Dt((t-r)/(e||1)),0),f=Array(i);i--;)f[n?i:++o]=r,r+=e;return f}(t,e,n=void 0===n?t<e?1:-1:Lt(n),r)}}(),Ht=Zt;function Jt(r,t,e){return r&&r.length?(t=e||void 0===t?1:function(r){var t=Lt(r),e=t%1;return t==t?e?t-e:t:0}(t),function(r,t,e){var n=-1,o=r.length;t<0&&(t=-t>o?0:o+t),(e=e>o?o:e)<0&&(e+=o),o=t>e?0:e-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=r[n+t];return i}(r,0,t<0?0:t)):[]}var Kt=Array.prototype.reverse;function Qt(r){return!(!function(r){return"[object String]"===Object.prototype.toString.call(r)}(r)||""===r)}function Xt(r){let t=!1;if(Qt(r))t=!isNaN(Number(r));else if(function(r){return"[object Number]"===Object.prototype.toString.call(r)}(r)){if(function(r){return r!=r}(r))return!1;t=!0}return t}function Yt(r){if(!Xt(r))return 0;return Lt(r)}function re(r){if(!Xt(r))return!1;return Yt(r)>0}function te(r){if(!Xt(r))return!1;return Yt(r)>=0}var ee="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},ne={},oe={};!function(r){(function(){var t,e="0.3.0",n="2013-03";(t=r).toString=function(){return"version "+e+", released "+n};for(var o=0,i=null,f=null,a={init:function(r){if(0===r||r&r-1)throw new Error("init: radix-2 required");o=r,a._initArray(),a._makeBitReversalTable(),a._makeCosSinTable()},fft1d:function(r,t){a.fft(r,t,1)},ifft1d:function(r,t){var e=1/o;a.fft(r,t,-1);for(var n=0;n<o;n++)r[n]*=e,t[n]*=e},bt1d:function(r,t){a.fft(r,t,-1)},fft2d:function(r,t){for(var e=[],n=[],i=0,f=0;f<o;f++){i=f*o;for(var u=0;u<o;u++)e[u]=r[u+i],n[u]=t[u+i];a.fft1d(e,n);for(var c=0;c<o;c++)r[c+i]=e[c],t[c+i]=n[c]}for(var l=0;l<o;l++){for(var s=0;s<o;s++)i=l+s*o,e[s]=r[i],n[s]=t[i];a.fft1d(e,n);for(var v=0;v<o;v++)r[i=l+v*o]=e[v],t[i]=n[v]}},ifft2d:function(r,t){for(var e=[],n=[],i=0,f=0;f<o;f++){i=f*o;for(var u=0;u<o;u++)e[u]=r[u+i],n[u]=t[u+i];a.ifft1d(e,n);for(var c=0;c<o;c++)r[c+i]=e[c],t[c+i]=n[c]}for(var l=0;l<o;l++){for(var s=0;s<o;s++)i=l+s*o,e[s]=r[i],n[s]=t[i];a.ifft1d(e,n);for(var v=0;v<o;v++)r[i=l+v*o]=e[v],t[i]=n[v]}},fft:function(r,t,e){for(var n,a,u,c,l,s,v,p,y,d=o>>2,h=0;h<o;h++)h<(c=i[h])&&(l=r[h],r[h]=r[c],r[c]=l,l=t[h],t[h]=t[c],t[c]=l);for(var b=1;b<o;b<<=1){a=0,n=o/(b<<1);for(var m=0;m<b;m++){s=f[a+d],v=e*f[a];for(var g=m;g<o;g+=b<<1)p=s*r[u=g+b]+v*t[u],y=s*t[u]-v*r[u],r[u]=r[g]-p,r[g]+=p,t[u]=t[g]-y,t[g]+=y;a+=n}}},_initArray:function(){i="undefined"!=typeof Uint32Array?new Uint32Array(o):[],f="undefined"!=typeof Float64Array?new Float64Array(1.25*o):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var r=0,t=0,e=0;for(i[0]=0;++r<o;){for(e=o>>1;e<=t;)t-=e,e>>=1;t+=e,i[r]=t}},_makeCosSinTable:function(){var r=o>>1,t=o>>2,e=o>>3,n=r+t,i=Math.sin(Math.PI/o),a=2*i*i,u=Math.sqrt(a*(2-a)),c=f[t]=1,l=f[0]=0;i=2*a;for(var s=1;s<e;s++)a+=i*(c-=a),u-=i*(l+=u),f[s]=l,f[t-s]=c;0!==e&&(f[e]=Math.sqrt(.5));for(var v=0;v<t;v++)f[r-v]=f[v];for(var p=0;p<n;p++)f[p+r]=-f[p]}},u=["init","fft1d","ifft1d","fft2d","ifft2d"],c=0;c<u.length;c++)t[u[c]]=a[u[c]];return t.bt=a.bt1d,t.fft=a.fft1d,t.ifft=a.ifft1d,t}).call(ee)}(oe);var ie=oe,fe={DEBUG:!1,ifft2DArray:function(r,t,e){var n=new Array(t*e),o=t/2,i=2*(e-1);ie.init(o);for(var f={re:new Array(o),im:new Array(o)},a=0;a<e;a++){for(var u=o-1;u>=0;u--)f.re[u]=r[2*u*e+a],f.im[u]=r[(2*u+1)*e+a];ie.bt(f.re,f.im);for(u=o-1;u>=0;u--)n[2*u*e+a]=f.re[u],n[(2*u+1)*e+a]=f.im[u]}var c=new Array(o*i);ie.init(i);var l={re:new Array(i),im:new Array(i)},s=i*o;for(u=0;u<t;u+=2){l.re[0]=n[u*e],l.im[0]=n[(u+1)*e];for(a=1;a<e;a++)l.re[a]=n[u*e+a],l.im[a]=n[(u+1)*e+a],l.re[i-a]=n[u*e+a],l.im[i-a]=-n[(u+1)*e+a];ie.bt(l.re,l.im);var v=u/2*i;for(a=i-1;a>=0;a--)c[v+a]=l.re[a]/s}return c},fft2DArray:function(r,t,e,n){Object.assign({},{inplace:!0});var o=e/2+1,i=2*t,f=new Array(i*o);ie.init(e);for(var a,u,c,l,s,v={re:new Array(e),im:new Array(e)},p={re:new Array(e),im:new Array(e)},y={re:new Array(e),im:new Array(e)},d=0;d<t/2;d++){a=2*d*e,v.re=r.slice(a,a+e),a=(2*d+1)*e,v.im=r.slice(a,a+e),ie.fft1d(v.re,v.im),this.reconstructTwoRealFFT(v,p,y),u=4*d*o,c=(4*d+1)*o,l=(4*d+2)*o,s=(4*d+3)*o;for(var h=o-1;h>=0;h--)f[u+h]=p.re[h],f[c+h]=p.im[h],f[l+h]=y.re[h],f[s+h]=y.im[h]}p=null,y=null;var b=new Array(i*o);ie.init(t);for(var m={re:new Array(t),im:new Array(t)},g=o-1;g>=0;g--){for(d=t-1;d>=0;d--)m.re[d]=f[2*d*o+g],m.im[d]=f[(2*d+1)*o+g],isNaN(m.re[d])&&(m.re[d]=0),isNaN(m.im[d])&&(m.im[d]=0);ie.fft1d(m.re,m.im);for(d=t-1;d>=0;d--)b[2*d*o+g]=m.re[d],b[(2*d+1)*o+g]=m.im[d]}return b},reconstructTwoRealFFT:function(r,t,e){var n,o,i,f,a,u=r.re.length;t.re[0]=r.re[0],t.im[0]=0,e.re[0]=r.im[0],e.im[0]=0;for(var c=u/2;c>0;c--)a=u-c,n=.5*(r.re[c]-r.re[a]),o=.5*(r.re[c]+r.re[a]),i=.5*(r.im[c]-r.im[a]),f=.5*(r.im[c]+r.im[a]),t.re[c]=o,t.im[c]=i,t.re[a]=o,t.im[a]=-i,e.re[c]=f,e.im[c]=-n,e.re[a]=f,e.im[a]=n},convolute2DI:function(r,t,e,n){for(var o,i,f=0;f<e/2;f++)for(var a=0;a<n;a++)o=r[2*f*n+a]*t[2*f*n+a]-r[(2*f+1)*n+a]*t[(2*f+1)*n+a],i=r[2*f*n+a]*t[(2*f+1)*n+a]+r[(2*f+1)*n+a]*t[2*f*n+a],r[2*f*n+a]=o,r[(2*f+1)*n+a]=i},convolute:function(r,t,e,n,o){for(var i=new Array(n*e),f=0;f<e*n;f++)i[f]=r[f];i=this.fft2DArray(i,e,n);var a,u=t.length,c=t[0].length,l=new Array(n*e);for(f=0;f<n*e;f++)l[f]=0;for(var s=Math.floor((u-1)/2),v=Math.floor((c-1)/2),p=0;p<u;p++){a=(p-s+e)%e;for(var y=0;y<c;y++)l[a*n+(y-v+n)%n]=t[p][y]}l=this.fft2DArray(l,e,n);var d=2*e,h=n/2+1;return this.convolute2DI(i,l,d,h),this.ifft2DArray(i,d,h)},toRadix2:function(r,t,e){var n,o,i,f,a=e,u=t;if(0===e||e&e-1){for(a=0;e>>++a;);a=1<<a}if(0===t||t&t-1){for(u=0;t>>++u;);u=1<<u}if(u==t&&a==e)return{data:r,rows:t,cols:e};var c=new Array(u*a),l=Math.floor((u-t)/2)-t,s=Math.floor((a-e)/2)-e;for(n=0;n<u;n++)for(i=n*a,f=(n-l)%t*e,o=0;o<a;o++)c[i+o]=r[f+(o-s)%e];return{data:c,rows:u,cols:a}},crop:function(r,t,e,n,o,i){if(t==n&&e==o)return r;Object.assign({},i);var f,a,u,c,l=new Array(o*n),s=Math.floor((t-n)/2),v=Math.floor((e-o)/2);for(u=0;u<n;u++)for(f=u*o,a=(u+s)*e,c=0;c<o;c++)l[f+c]=r[a+(c+v)];return l}};ne.FFTUtils=fe,ne.FFT=oe;let ae=ne.FFT;function ue(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"norm";if("norm"!==t&&"inv"!==t)throw new Error(`invalid mode[${t}]`);let e=function(r){let t=1,e=Math.pow(2,52);for(;t*=2,!(r<=t||t>=e););return t}(tt(r));ae.init(e);let n=new Array(e),o=new Array(e);if("norm"===t)for(let t=0;t<e;t++){let e=sr(r,t,0),i=0;n[t]=e,o[t]=i}else for(let t=0;t<e;t++){let e=sr(r,`${t}.0`,0),i=sr(r,`${t}.1`,0);n[t]=e,o[t]=i}let i=[];if("norm"===t){ae.fft(n,o);for(let r=0;r<e;r++){let t=n[r],e=o[r];i.push([t,e])}}else{ae.ifft(n,o);for(let r=0;r<e;r++){let t=n[r];i.push(t)}}return i}let ce=r=>ue(r,"norm"),le=r=>ue(r,"inv");return{fft1d:ce,ifft1d:le,fft2d:r=>{},ifft2d:r=>{},spectrum1d:function(r,t){if(!re(t))throw new Error(`dt[${t}] is not a positive number`);t=Yt(t);let e=ce(r),n=tt(e),o=1/(t*(n-1)),i=Ht(0,o*(n-1),o);i=Jt(i,n/2);let f=[];return Pt(i,((r,t)=>{let n={freq:r,real:e[t][0],imag:e[t][1],ampl:Math.sqrt(e[t][0]**2+e[t][1]**2)};f.push(n)})),f},filter1d:function(r,t,e,n){if(!re(t))throw new Error(`dt[${t}] is not a positive number`);if(t=Yt(t),!te(e))throw new Error(`hzStart[${e}] is not a positive number`);if(e=Yt(e),!te(n))throw new Error(`hzEnd[${n}] is not a positive number`);n=Yt(n);let o=ce(r),i=tt(o),f=1/(t*(i-1)),a=Ht(0,f*(i-1),f),u=Jt(a,i/2);var c;return a=[...u,...(c=u,null==c?c:Kt.call(c))],Pt(a,((r,t)=>{e<=r&&r<=n||(o[t][0]=0,o[t][1]=0)})),le(o)}}}));
//# sourceMappingURL=w-fft.umd.js.map
