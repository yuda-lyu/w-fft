/*!
 * w-fft v1.0.0
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(r="undefined"!=typeof globalThis?globalThis:r||self)["w-fft"]=t()}(this,(function(){"use strict";var r=Array.isArray,t="object"==typeof global&&global&&global.Object===Object&&global,e="object"==typeof self&&self&&self.Object===Object&&self,n=t||e||Function("return this")(),o=n.Symbol,i=Object.prototype,f=i.hasOwnProperty,a=i.toString,u=o?o.toStringTag:void 0;var c=Object.prototype.toString;var l="[object Null]",s="[object Undefined]",v=o?o.toStringTag:void 0;function d(r){return null==r?void 0===r?s:l:v&&v in Object(r)?function(r){var t=f.call(r,u),e=r[u];try{r[u]=void 0;var n=!0}catch(r){}var o=a.call(r);return n&&(t?r[u]=e:delete r[u]),o}(r):function(r){return c.call(r)}(r)}function p(r){return null!=r&&"object"==typeof r}var h="[object Symbol]";function y(r){return"symbol"==typeof r||p(r)&&d(r)==h}var _=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,b=/^\w*$/;function g(r){var t=typeof r;return null!=r&&("object"==t||"function"==t)}var m="[object AsyncFunction]",w="[object Function]",j="[object GeneratorFunction]",A="[object Proxy]";function O(r){if(!g(r))return!1;var t=d(r);return t==w||t==j||t==m||t==A}var T,F=n["__core-js_shared__"],S=(T=/[^.]+$/.exec(F&&F.keys&&F.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"";var M=Function.prototype.toString;function z(r){if(null!=r){try{return M.call(r)}catch(r){}try{return r+""}catch(r){}}return""}var $=/^\[object .+?Constructor\]$/,x=Function.prototype,P=Object.prototype,D=x.toString,k=P.hasOwnProperty,E=RegExp("^"+D.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function R(r){return!(!g(r)||(t=r,S&&S in t))&&(O(r)?E:$).test(z(r));var t}function C(r,t){var e=function(r,t){return null==r?void 0:r[t]}(r,t);return R(e)?e:void 0}var I=C(Object,"create");var N=Object.prototype.hasOwnProperty;var U=Object.prototype.hasOwnProperty;function q(r){var t=-1,e=null==r?0:r.length;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}function B(r,t){for(var e,n,o=r.length;o--;)if((e=r[o][0])===(n=t)||e!=e&&n!=n)return o;return-1}q.prototype.clear=function(){this.__data__=I?I(null):{},this.size=0},q.prototype.delete=function(r){var t=this.has(r)&&delete this.__data__[r];return this.size-=t?1:0,t},q.prototype.get=function(r){var t=this.__data__;if(I){var e=t[r];return"__lodash_hash_undefined__"===e?void 0:e}return N.call(t,r)?t[r]:void 0},q.prototype.has=function(r){var t=this.__data__;return I?void 0!==t[r]:U.call(t,r)},q.prototype.set=function(r,t){var e=this.__data__;return this.size+=this.has(r)?0:1,e[r]=I&&void 0===t?"__lodash_hash_undefined__":t,this};var G=Array.prototype.splice;function V(r){var t=-1,e=null==r?0:r.length;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}V.prototype.clear=function(){this.__data__=[],this.size=0},V.prototype.delete=function(r){var t=this.__data__,e=B(t,r);return!(e<0)&&(e==t.length-1?t.pop():G.call(t,e,1),--this.size,!0)},V.prototype.get=function(r){var t=this.__data__,e=B(t,r);return e<0?void 0:t[e][1]},V.prototype.has=function(r){return B(this.__data__,r)>-1},V.prototype.set=function(r,t){var e=this.__data__,n=B(e,r);return n<0?(++this.size,e.push([r,t])):e[n][1]=t,this};var W=C(n,"Map");function Z(r,t){var e,n,o=r.__data__;return("string"==(n=typeof(e=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e)?o["string"==typeof t?"string":"hash"]:o.map}function H(r){var t=-1,e=null==r?0:r.length;for(this.clear();++t<e;){var n=r[t];this.set(n[0],n[1])}}H.prototype.clear=function(){this.size=0,this.__data__={hash:new q,map:new(W||V),string:new q}},H.prototype.delete=function(r){var t=Z(this,r).delete(r);return this.size-=t?1:0,t},H.prototype.get=function(r){return Z(this,r).get(r)},H.prototype.has=function(r){return Z(this,r).has(r)},H.prototype.set=function(r,t){var e=Z(this,r),n=e.size;return e.set(r,t),this.size+=e.size==n?0:1,this};var J="Expected a function";function K(r,t){if("function"!=typeof r||null!=t&&"function"!=typeof t)throw new TypeError(J);var e=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=e.cache;if(i.has(o))return i.get(o);var f=r.apply(this,n);return e.cache=i.set(o,f)||i,f};return e.cache=new(K.Cache||H),e}K.Cache=H;var L,Q,X,Y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,rr=/\\(\\)?/g,tr=(L=function(r){var t=[];return 46===r.charCodeAt(0)&&t.push(""),r.replace(Y,(function(r,e,n,o){t.push(n?o.replace(rr,"$1"):e||r)})),t},Q=K(L,(function(r){return 500===X.size&&X.clear(),r})),X=Q.cache,Q),er=tr;var nr=1/0,or=o?o.prototype:void 0,ir=or?or.toString:void 0;function fr(t){if("string"==typeof t)return t;if(r(t))return function(r,t){for(var e=-1,n=null==r?0:r.length,o=Array(n);++e<n;)o[e]=t(r[e],e,r);return o}(t,fr)+"";if(y(t))return ir?ir.call(t):"";var e=t+"";return"0"==e&&1/t==-nr?"-0":e}function ar(t,e){return r(t)?t:function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!y(t))||b.test(t)||!_.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:er(function(r){return null==r?"":fr(r)}(t))}var ur=1/0;function cr(r){if("string"==typeof r||y(r))return r;var t=r+"";return"0"==t&&1/r==-ur?"-0":t}function lr(r,t,e){var n=null==r?void 0:function(r,t){for(var e=0,n=(t=ar(t,r)).length;null!=r&&e<n;)r=r[cr(t[e++])];return e&&e==n?r:void 0}(r,t);return void 0===n?e:n}var sr=Object.prototype;var vr=function(r,t){return function(e){return r(t(e))}}(Object.keys,Object),dr=vr,pr=Object.prototype.hasOwnProperty;function hr(r){if(e=(t=r)&&t.constructor,t!==("function"==typeof e&&e.prototype||sr))return dr(r);var t,e,n=[];for(var o in Object(r))pr.call(r,o)&&"constructor"!=o&&n.push(o);return n}var yr=C(n,"DataView"),_r=C(n,"Promise"),br=C(n,"Set"),gr=C(n,"WeakMap"),mr="[object Map]",wr="[object Promise]",jr="[object Set]",Ar="[object WeakMap]",Or="[object DataView]",Tr=z(yr),Fr=z(W),Sr=z(_r),Mr=z(br),zr=z(gr),$r=d;(yr&&$r(new yr(new ArrayBuffer(1)))!=Or||W&&$r(new W)!=mr||_r&&$r(_r.resolve())!=wr||br&&$r(new br)!=jr||gr&&$r(new gr)!=Ar)&&($r=function(r){var t=d(r),e="[object Object]"==t?r.constructor:void 0,n=e?z(e):"";if(n)switch(n){case Tr:return Or;case Fr:return mr;case Sr:return wr;case Mr:return jr;case zr:return Ar}return t});var xr=$r,Pr=9007199254740991;function Dr(r){return null!=r&&function(r){return"number"==typeof r&&r>-1&&r%1==0&&r<=Pr}(r.length)&&!O(r)}var kr="[object String]";var Er,Rr=(Er="length",function(r){return null==r?void 0:r[Er]}),Cr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Ir="\\ud800-\\udfff",Nr="["+Ir+"]",Ur="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",qr="\\ud83c[\\udffb-\\udfff]",Br="[^"+Ir+"]",Gr="(?:\\ud83c[\\udde6-\\uddff]){2}",Vr="[\\ud800-\\udbff][\\udc00-\\udfff]",Wr="(?:"+Ur+"|"+qr+")"+"?",Zr="[\\ufe0e\\ufe0f]?",Hr=Zr+Wr+("(?:\\u200d(?:"+[Br,Gr,Vr].join("|")+")"+Zr+Wr+")*"),Jr="(?:"+[Br+Ur+"?",Ur,Gr,Vr,Nr].join("|")+")",Kr=RegExp(qr+"(?="+qr+")|"+Jr+Hr,"g");function Lr(r){return function(r){return Cr.test(r)}(r)?function(r){for(var t=Kr.lastIndex=0;Kr.test(r);)++t;return t}(r):Rr(r)}var Qr="[object Map]",Xr="[object Set]";function Yr(t){if(null==t)return 0;if(Dr(t))return"string"==typeof(e=t)||!r(e)&&p(e)&&d(e)==kr?Lr(t):t.length;var e,n=xr(t);return n==Qr||n==Xr?t.size:hr(t).length}var rt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},tt={},et={};!function(r){(function(){var t,e="0.3.0",n="2013-03";(t=r).toString=function(){return"version "+e+", released "+n};for(var o=0,i=null,f=null,a={init:function(r){if(0===r||r&r-1)throw new Error("init: radix-2 required");o=r,a._initArray(),a._makeBitReversalTable(),a._makeCosSinTable()},fft1d:function(r,t){a.fft(r,t,1)},ifft1d:function(r,t){var e=1/o;a.fft(r,t,-1);for(var n=0;n<o;n++)r[n]*=e,t[n]*=e},bt1d:function(r,t){a.fft(r,t,-1)},fft2d:function(r,t){for(var e=[],n=[],i=0,f=0;f<o;f++){i=f*o;for(var u=0;u<o;u++)e[u]=r[u+i],n[u]=t[u+i];a.fft1d(e,n);for(var c=0;c<o;c++)r[c+i]=e[c],t[c+i]=n[c]}for(var l=0;l<o;l++){for(var s=0;s<o;s++)i=l+s*o,e[s]=r[i],n[s]=t[i];a.fft1d(e,n);for(var v=0;v<o;v++)r[i=l+v*o]=e[v],t[i]=n[v]}},ifft2d:function(r,t){for(var e=[],n=[],i=0,f=0;f<o;f++){i=f*o;for(var u=0;u<o;u++)e[u]=r[u+i],n[u]=t[u+i];a.ifft1d(e,n);for(var c=0;c<o;c++)r[c+i]=e[c],t[c+i]=n[c]}for(var l=0;l<o;l++){for(var s=0;s<o;s++)i=l+s*o,e[s]=r[i],n[s]=t[i];a.ifft1d(e,n);for(var v=0;v<o;v++)r[i=l+v*o]=e[v],t[i]=n[v]}},fft:function(r,t,e){for(var n,a,u,c,l,s,v,d,p,h=o>>2,y=0;y<o;y++)y<(c=i[y])&&(l=r[y],r[y]=r[c],r[c]=l,l=t[y],t[y]=t[c],t[c]=l);for(var _=1;_<o;_<<=1){a=0,n=o/(_<<1);for(var b=0;b<_;b++){s=f[a+h],v=e*f[a];for(var g=b;g<o;g+=_<<1)d=s*r[u=g+_]+v*t[u],p=s*t[u]-v*r[u],r[u]=r[g]-d,r[g]+=d,t[u]=t[g]-p,t[g]+=p;a+=n}}},_initArray:function(){i="undefined"!=typeof Uint32Array?new Uint32Array(o):[],f="undefined"!=typeof Float64Array?new Float64Array(1.25*o):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var r=0,t=0,e=0;for(i[0]=0;++r<o;){for(e=o>>1;e<=t;)t-=e,e>>=1;t+=e,i[r]=t}},_makeCosSinTable:function(){var r=o>>1,t=o>>2,e=o>>3,n=r+t,i=Math.sin(Math.PI/o),a=2*i*i,u=Math.sqrt(a*(2-a)),c=f[t]=1,l=f[0]=0;i=2*a;for(var s=1;s<e;s++)a+=i*(c-=a),u-=i*(l+=u),f[s]=l,f[t-s]=c;0!==e&&(f[e]=Math.sqrt(.5));for(var v=0;v<t;v++)f[r-v]=f[v];for(var d=0;d<n;d++)f[d+r]=-f[d]}},u=["init","fft1d","ifft1d","fft2d","ifft2d"],c=0;c<u.length;c++)t[u[c]]=a[u[c]];return t.bt=a.bt1d,t.fft=a.fft1d,t.ifft=a.ifft1d,t}).call(rt)}(et);var nt=et,ot={DEBUG:!1,ifft2DArray:function(r,t,e){var n=new Array(t*e),o=t/2,i=2*(e-1);nt.init(o);for(var f={re:new Array(o),im:new Array(o)},a=0;a<e;a++){for(var u=o-1;u>=0;u--)f.re[u]=r[2*u*e+a],f.im[u]=r[(2*u+1)*e+a];nt.bt(f.re,f.im);for(u=o-1;u>=0;u--)n[2*u*e+a]=f.re[u],n[(2*u+1)*e+a]=f.im[u]}var c=new Array(o*i);nt.init(i);var l={re:new Array(i),im:new Array(i)},s=i*o;for(u=0;u<t;u+=2){l.re[0]=n[u*e],l.im[0]=n[(u+1)*e];for(a=1;a<e;a++)l.re[a]=n[u*e+a],l.im[a]=n[(u+1)*e+a],l.re[i-a]=n[u*e+a],l.im[i-a]=-n[(u+1)*e+a];nt.bt(l.re,l.im);var v=u/2*i;for(a=i-1;a>=0;a--)c[v+a]=l.re[a]/s}return c},fft2DArray:function(r,t,e,n){Object.assign({},{inplace:!0});var o=e/2+1,i=2*t,f=new Array(i*o);nt.init(e);for(var a,u,c,l,s,v={re:new Array(e),im:new Array(e)},d={re:new Array(e),im:new Array(e)},p={re:new Array(e),im:new Array(e)},h=0;h<t/2;h++){a=2*h*e,v.re=r.slice(a,a+e),a=(2*h+1)*e,v.im=r.slice(a,a+e),nt.fft1d(v.re,v.im),this.reconstructTwoRealFFT(v,d,p),u=4*h*o,c=(4*h+1)*o,l=(4*h+2)*o,s=(4*h+3)*o;for(var y=o-1;y>=0;y--)f[u+y]=d.re[y],f[c+y]=d.im[y],f[l+y]=p.re[y],f[s+y]=p.im[y]}d=null,p=null;var _=new Array(i*o);nt.init(t);for(var b={re:new Array(t),im:new Array(t)},g=o-1;g>=0;g--){for(h=t-1;h>=0;h--)b.re[h]=f[2*h*o+g],b.im[h]=f[(2*h+1)*o+g],isNaN(b.re[h])&&(b.re[h]=0),isNaN(b.im[h])&&(b.im[h]=0);nt.fft1d(b.re,b.im);for(h=t-1;h>=0;h--)_[2*h*o+g]=b.re[h],_[(2*h+1)*o+g]=b.im[h]}return _},reconstructTwoRealFFT:function(r,t,e){var n,o,i,f,a,u=r.re.length;t.re[0]=r.re[0],t.im[0]=0,e.re[0]=r.im[0],e.im[0]=0;for(var c=u/2;c>0;c--)a=u-c,n=.5*(r.re[c]-r.re[a]),o=.5*(r.re[c]+r.re[a]),i=.5*(r.im[c]-r.im[a]),f=.5*(r.im[c]+r.im[a]),t.re[c]=o,t.im[c]=i,t.re[a]=o,t.im[a]=-i,e.re[c]=f,e.im[c]=-n,e.re[a]=f,e.im[a]=n},convolute2DI:function(r,t,e,n){for(var o,i,f=0;f<e/2;f++)for(var a=0;a<n;a++)o=r[2*f*n+a]*t[2*f*n+a]-r[(2*f+1)*n+a]*t[(2*f+1)*n+a],i=r[2*f*n+a]*t[(2*f+1)*n+a]+r[(2*f+1)*n+a]*t[2*f*n+a],r[2*f*n+a]=o,r[(2*f+1)*n+a]=i},convolute:function(r,t,e,n,o){for(var i=new Array(n*e),f=0;f<e*n;f++)i[f]=r[f];i=this.fft2DArray(i,e,n);var a,u=t.length,c=t[0].length,l=new Array(n*e);for(f=0;f<n*e;f++)l[f]=0;for(var s=Math.floor((u-1)/2),v=Math.floor((c-1)/2),d=0;d<u;d++){a=(d-s+e)%e;for(var p=0;p<c;p++)l[a*n+(p-v+n)%n]=t[d][p]}l=this.fft2DArray(l,e,n);var h=2*e,y=n/2+1;return this.convolute2DI(i,l,h,y),this.ifft2DArray(i,h,y)},toRadix2:function(r,t,e){var n,o,i,f,a=e,u=t;if(0===e||e&e-1){for(a=0;e>>++a;);a=1<<a}if(0===t||t&t-1){for(u=0;t>>++u;);u=1<<u}if(u==t&&a==e)return{data:r,rows:t,cols:e};var c=new Array(u*a),l=Math.floor((u-t)/2)-t,s=Math.floor((a-e)/2)-e;for(n=0;n<u;n++)for(i=n*a,f=(n-l)%t*e,o=0;o<a;o++)c[i+o]=r[f+(o-s)%e];return{data:c,rows:u,cols:a}},crop:function(r,t,e,n,o,i){if(t==n&&e==o)return r;Object.assign({},i);var f,a,u,c,l=new Array(o*n),s=Math.floor((t-n)/2),v=Math.floor((e-o)/2);for(u=0;u<n;u++)for(f=u*o,a=(u+s)*e,c=0;c<o;c++)l[f+c]=r[a+(c+v)];return l}};tt.FFTUtils=ot,tt.FFT=et;let it=tt.FFT;function ft(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"norm";if("norm"!==t&&"inv"!==t)throw new Error(`invalid mode[${t}]`);let e=function(r){let t=1;for(;t*=2,!(r<=t||t>=104););return t}(Yr(r));it.init(e);let n=new Array(e),o=new Array(e);if("norm"===t)for(let t=0;t<e;t++){let e=lr(r,t,0),i=0;n[t]=e,o[t]=i}else for(let t=0;t<e;t++){let e=lr(r,`${t}.0`,0),i=lr(r,`${t}.1`,0);n[t]=e,o[t]=i}let i=[];if("norm"===t){it.fft(n,o);for(let r=0;r<e;r++){let t=n[r],e=o[r];i.push([t,e])}}else{it.ifft(n,o);for(let r=0;r<e;r++){let t=n[r],e=o[r],f=Math.sqrt(t*t,e*e);i.push(f)}}return i}return{fft1d:r=>ft(r,"norm"),ifft1d:r=>ft(r,"inv"),fft2d:r=>{},ifft2d:r=>{}}}));
//# sourceMappingURL=w-fft.umd.js.map
