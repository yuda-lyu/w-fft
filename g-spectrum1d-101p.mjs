import fs from 'fs'
import _ from 'lodash-es'
import w from 'wsemi'
import wf from './src/WFft.mjs'

let dt
let arr
let res

//dt=0.01s, 3+6hz
dt = 0.01

arr = [
    0,
    0.555505867270403,
    1.05267165861337,
    1.44065384744502,
    1.68257383435696,
    1.7600735106701,
    1.67534029524181,
    1.45033683523035,
    1.12335996199258,
    0.743424814149623,
    0.363271264002681,
    0.0319787545418488,
    -0.211774007952899,
    -0.344863260979999,
    -0.3625742514003,
    -0.278768257917526,
    -0.12335665360055,
    0.0625427140349913,
    0.233063786936861,
    0.344733951210717,
    0.36327126400268,
    0.26905810100686,
    0.0604991269640027,
    -0.245229379959565,
    -0.614162698044014,
    -1,
    -1.35041180341337,
    -1.61432359181694,
    -1.74915497796803,
    -1.72699535584968,
    -1.53884176858762,
    -1.19629253434086,
    -0.730443561266567,
    -0.188123753093612,
    0.374023120729167,
    0.896802246667427,
    1.32608159960373,
    1.61971124047738,
    1.75280049350448,
    1.72063460554588,
    1.53884176858762,
    1.24080458847933,
    0.872693494863958,
    0.486829487026909,
    0.134313809690226,
    -0.14203952192021,
    -0.313479622499585,
    -0.369000257487023,
    -0.316422553244008,
    -0.18074323809895,
    3.18516914232791E-15,
    0.180743238098957,
    0.316422553244013,
    0.369000257487023,
    0.31347962249958,
    0.1420395219202,
    -0.13431380969024,
    -0.486829487026929,
    -0.872693494863978,
    -1.24080458847934,
    -1.53884176858763,
    -1.72063460554588,
    -1.75280049350448,
    -1.61971124047737,
    -1.32608159960372,
    -0.896802246667399,
    -0.374023120729138,
    0.188123753093636,
    0.730443561266589,
    1.19629253434087,
    1.53884176858764,
    1.72699535584969,
    1.74915497796803,
    1.61432359181693,
    1.35041180341335,
    0.999999999999983,
    0.614162698043992,
    0.245229379959548,
    -0.0604991269640165,
    -0.269058101006866,
    -0.363271264002682,
    -0.344733951210713,
    -0.233063786936854,
    -0.0625427140349806,
    0.123356653600559,
    0.278768257917534,
    0.362574251400301,
    0.344863260979995,
    0.211774007952891,
    -0.0319787545418657,
    -0.3632712640027,
    -0.743424814149649,
    -1.1233599619926,
    -1.45033683523036,
    -1.67534029524182,
    -1.7600735106701,
    -1.68257383435695,
    -1.440653847445,
    -1.05267165861334,
    -0.555505867270371,
    4.04272969267705E-14,
]

res = wf.spectrum1d(arr, dt)
w.downloadExcelFileFromData('./spectrum1d-101p.xlsx', 'data', res)
fs.writeFileSync('./spectrum1d_101p.json', JSON.stringify(res), 'utf8')
console.log(res)
// => [
//   {
//     freq: 0,
//     real: 4.159888579435833e-14,
//     imag: 0,
//     ampl: 4.159888579435833e-14
//   },
//   {
//     freq: 0.7874015748031495,
//     real: 6.714745922866065,
//     imag: -8.181941580439723,
//     ampl: 10.58451608881459
//   },
//   ...
// ]

//node g-spectrum1d-101p.mjs
