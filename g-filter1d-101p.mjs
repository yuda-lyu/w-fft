import fs from 'fs'
import _ from 'lodash-es'
import w from 'wsemi'
import wf from './src/WFft.mjs'

let dt
let arr
let res

//dt=0.01s, 3+6hz
dt = 0.01

arr = [
    0,
    0.555505867270403,
    1.05267165861337,
    1.44065384744502,
    1.68257383435696,
    1.7600735106701,
    1.67534029524181,
    1.45033683523035,
    1.12335996199258,
    0.743424814149623,
    0.363271264002681,
    0.0319787545418488,
    -0.211774007952899,
    -0.344863260979999,
    -0.3625742514003,
    -0.278768257917526,
    -0.12335665360055,
    0.0625427140349913,
    0.233063786936861,
    0.344733951210717,
    0.36327126400268,
    0.26905810100686,
    0.0604991269640027,
    -0.245229379959565,
    -0.614162698044014,
    -1,
    -1.35041180341337,
    -1.61432359181694,
    -1.74915497796803,
    -1.72699535584968,
    -1.53884176858762,
    -1.19629253434086,
    -0.730443561266567,
    -0.188123753093612,
    0.374023120729167,
    0.896802246667427,
    1.32608159960373,
    1.61971124047738,
    1.75280049350448,
    1.72063460554588,
    1.53884176858762,
    1.24080458847933,
    0.872693494863958,
    0.486829487026909,
    0.134313809690226,
    -0.14203952192021,
    -0.313479622499585,
    -0.369000257487023,
    -0.316422553244008,
    -0.18074323809895,
    3.18516914232791E-15,
    0.180743238098957,
    0.316422553244013,
    0.369000257487023,
    0.31347962249958,
    0.1420395219202,
    -0.13431380969024,
    -0.486829487026929,
    -0.872693494863978,
    -1.24080458847934,
    -1.53884176858763,
    -1.72063460554588,
    -1.75280049350448,
    -1.61971124047737,
    -1.32608159960372,
    -0.896802246667399,
    -0.374023120729138,
    0.188123753093636,
    0.730443561266589,
    1.19629253434087,
    1.53884176858764,
    1.72699535584969,
    1.74915497796803,
    1.61432359181693,
    1.35041180341335,
    0.999999999999983,
    0.614162698043992,
    0.245229379959548,
    -0.0604991269640165,
    -0.269058101006866,
    -0.363271264002682,
    -0.344733951210713,
    -0.233063786936854,
    -0.0625427140349806,
    0.123356653600559,
    0.278768257917534,
    0.362574251400301,
    0.344863260979995,
    0.211774007952891,
    -0.0319787545418657,
    -0.3632712640027,
    -0.743424814149649,
    -1.1233599619926,
    -1.45033683523036,
    -1.67534029524182,
    -1.7600735106701,
    -1.68257383435695,
    -1.440653847445,
    -1.05267165861334,
    -0.555505867270371,
    4.04272969267705E-14,
]

res = wf.filter1d(arr, dt, 0, 2)
fs.writeFileSync('./filter1d_101p_0_2Hz.txt', _.join(_.map(res, w.cstr), '\n'), 'utf8')
console.log(res)
// => [
//     0.6108099399414366,    0.6032922730736443,    0.5885457487372485,
//     0.5670205578362839,    0.5392724621922225,    0.5059506766997263,
//      0.467784084791924,    0.4255660812435606,    0.3801383627682326,
//     0.3323740064346117,    0.2831601882430663,    0.2333808990314374,
//     0.1839000121406144,    0.1355450470529515,   0.08909195576538358,
//   0.045251234374815805,  0.004655631781987302, -0.032150308758813376,
//   -0.06471868050477615,  -0.09270446666245248,  -0.11586951438240892,
//   -0.13408417700702768,   -0.1473266227875919,  -0.15567985852014948,
//    -0.1593265654122158,  -0.15854189093255552,   -0.1536843834179457,
//   -0.14518529489478985,   -0.1335365110972867,  -0.11927739531950221,
//   -0.10298085394763881,  -0.08523894584442127,    -0.066648364914288,
//   -0.04779612503753694, -0.029245769154821077, -0.011524409800176716,
//    0.00488911283492538,  0.019574696681695702,   0.03217984186709344,
//   0.042426725470348925,   0.05011734131025003,  0.055136604142913825,
//    0.05745336475248225,  0.057119330541116176,   0.05426593429999374,
//   0.049099240802547905,   0.04189302566374299,  0.032980202562413616,
//   0.022742812505684544,  0.011600821494012339, -6.28415587411101e-17,
//   -0.01160082149401246, -0.022742812505684627, -0.032980202562413616,
//  -0.041893025663742964, -0.049099240802547794,  -0.05426593429999352,
//    -0.0571193305411159,  -0.05745336475248197,  -0.05513660414291352,
//   -0.05011734131024964, -0.042426725470348536,  -0.03217984186709294,
//  -0.019574696681695147, -0.004889112834924825,  0.011524409800177382,
//   0.029245769154821744,   0.04779612503753755,   0.06664836491428858,
//    0.08523894584442185,   0.10298085394763934,    0.1192773953195026,
//    0.13353651109728698,   0.14518529489478996,   0.15368438341794569,
//    0.15854189093255536,   0.15932656541221546,   0.15567985852014904,
//    0.14732662278759123,   0.13408417700702685,   0.11586951438240796,
//    0.09270446666245137,    0.0647186805047749,   0.03215030875881203,
// -0.0046556317819887935,  -0.04525123437481738,  -0.08909195576538519,
//   -0.13554504705295306,  -0.18390001214061596,   -0.2333808990314389,
//    -0.2831601882430676,   -0.3323740064346128,  -0.38013836276823365,
//   -0.42556608124356143,   -0.4677840847919247,   -0.5059506766997265,
//    -0.5392724621922225,   -0.5670205578362835,   -0.5885457487372479,
//    -0.6032922730736434,
// ... 28 more items
// ]

res = wf.filter1d(arr, dt, 0, 4)
fs.writeFileSync('./filter1d_101p_0_4Hz.txt', _.join(_.map(res, w.cstr), '\n'), 'utf8')
console.log(res)
// => [
//     0.5699606034659401,   0.6749582842219397,    0.7715569721283863,
//     0.8555903357937928,   0.9232998026888879,    0.9714850648877033,
//     0.9976244385475797,   0.9999619803555505,    0.9775603867030607,
//     0.9303206264697538,   0.8589708538077515,    0.7650283197304913,
//     0.6507387024260662,   0.5189975054435318,    0.3732579751629945,
//    0.21742944843477363, 0.055769271604713455,  -0.10722943594426307,
//   -0.26695273312766793, -0.41878275644514096,   -0.5582162153483414,
//    -0.6809842224312095,  -0.7831729385652295,   -0.8613439246289731,
//    -0.9126522354218722,  -0.9349592673739412,   -0.9269363075342448,
//    -0.8881537706369607,  -0.8191503990705129,   -0.7214763694870376,
//    -0.5977044046561831,  -0.4514036959938592,   -0.2870727191579493,
//   -0.11002883785175455,   0.0737451474470121,   0.25779477363114234,
//    0.43542256417488845,   0.5999434496235717,    0.7449564692946129,
//      0.864620350792694,   0.9539193027874704,    1.0089048869215127,
//     1.0269002432399792,   1.0066542547103652,    0.9484354084489833,
//     0.8540580369613242,   0.7268371355010863,    0.5714718367149154,
//     0.3938616329589801,    0.200863306610152, -4.74764092387614e-15,
//   -0.20086330661016127, -0.39386163295898885,   -0.5714718367149232,
//     -0.726837135501093,  -0.8540580369613293,   -0.9484354084489867,
//    -1.0066542547103667,  -1.0269002432399792,   -1.0089048869215107,
//    -0.9539193027874668,  -0.8646203507926887,   -0.7449564692946065,
//     -0.599943449623564, -0.43542256417487996,   -0.2577947736311336,
//   -0.07374514744700322,  0.11002883785176326,   0.28707271915795746,
//    0.45140369599386687,   0.5977044046561897,    0.7214763694870431,
//     0.8191503990705171,   0.8881537706369634,    0.9269363075342462,
//      0.934959267373941,   0.9126522354218709,      0.86134392462897,
//     0.7831729385652251,   0.6809842224312039,    0.5582162153483348,
//     0.4187827564451334,   0.2669527331276597,   0.10722943594425441,
//   -0.05576927160472234,  -0.2174294484347825,    -0.373257975163003,
//    -0.5189975054435396,  -0.6507387024260731,   -0.7650283197304969,
//    -0.8589708538077557,  -0.9303206264697563,   -0.9775603867030618,
//    -0.9999619803555497,  -0.9976244385475771,   -0.9714850648876989,
//    -0.9232998026888818,  -0.8555903357937854,   -0.7715569721283776,
//    -0.6749582842219302,
//   ... 28 more items
// ]

res = wf.filter1d(arr, dt, 4, 8)
fs.writeFileSync('./filter1d_101p_4_8Hz.txt', _.join(_.map(res, w.cstr), '\n'), 'utf8')
console.log(res)
// => [
//    -0.16249342715374998, 0.023320852246266455,   0.23351292690927483,
//      0.4320370898683823,   0.5803614411352451,    0.6449267547131803,
//      0.6043886912856682,   0.4550611103715187,   0.21324835012595245,
//     -0.0862585662463855, -0.39546355895859686,   -0.6613590757322476,
//     -0.8355162132340934,  -0.8832141027738915,   -0.7902980565733727,
//     -0.5663845067916715,  -0.2437484533328727,   0.12791997829961027,
//     0.48990150266667126,   0.7844017177466338,    0.9642422310359067,
//      1.0005688665092647,   0.8872933047118924,    0.6416382678084342,
//      0.3008823781848845, -0.08394833820876596,   -0.4562370150163346,
//     -0.7623745167174137,  -0.9594557127411248,    -1.021005503857275,
//     -0.9400753245441237,  -0.7294990477628367,  -0.41950401997374487,
//   -0.053184575368400294,   0.3194595726984145,    0.6481327683103966,
//      0.8887157240654933,    1.008879267743764,     0.992224153803808,
//      0.8404735206197176,   0.5734251658166416,   0.22659429260096034,
//     -0.1532603238939656,    -0.51425259761018,   -0.8063910878213314,
//     -0.9885756995925197,   -1.034562621653092,    -0.936970324819612,
//     -0.7086426188592789,  -0.3810661162997715, 8.517855222569761e-15,
//      0.3810661162997874,   0.7086426188592914,    0.9369703248196191,
//      1.0345626216530932,   0.9885756995925146,    0.8063910878213206,
//      0.5142525976101653,    0.153260323893949,   -0.2265942926009767,
//     -0.5734251658166556,  -0.8404735206197268,   -0.9922241538038117,
//      -1.008879267743762,   -0.888715724065485,   -0.6481327683103836,
//     -0.3194595726983983, 0.053184575368417614,   0.41950401997376097,
//      0.7294990477628494,   0.9400753245441311,     1.021005503857276,
//      0.9594557127411191,   0.7623745167174016,   0.45623701501631786,
//      0.0839483382087467, -0.30088237818490343,   -0.6416382678084499,
//     -0.8872933047119024,  -1.0005688665092676,   -0.9642422310359016,
//     -0.7844017177466214,  -0.4899015026666534,   -0.1279199782995898,
//      0.2437484533328924,   0.5663845067916873,    0.7902980565733823,
//      0.8832141027738933,   0.8355162132340873,    0.6613590757322347,
//     0.39546355895857965,  0.08625856624636696,   -0.2132483501259691,
//      -0.455061110371531,  -0.6043886912856743,   -0.6449267547131798,
//     -0.5803614411352384, -0.43203708986837086,  -0.23351292690926118,
//   -0.023320852246252965,
//   ... 28 more items
// ]

//node g-filter1d-101p.mjs
